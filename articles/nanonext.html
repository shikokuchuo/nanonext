<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>nanonext - NNG Lightweight Messaging Library • nanonext</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="nanonext - NNG Lightweight Messaging Library">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nanonext</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/nanonext.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/shikokuchuo/nanonext/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://shikokuchuo.net/" aria-label="shikokuchuo"><span class="fa fa-cube"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>nanonext - NNG Lightweight Messaging Library</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/shikokuchuo/nanonext/blob/main/vignettes/nanonext.Rmd" class="external-link"><code>vignettes/nanonext.Rmd</code></a></small>
      <div class="d-none name"><code>nanonext.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="table-of-contents">Table of Contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h3>
<ol style="list-style-type: decimal">
<li><a href="#cross-language-exchange">Cross-language Exchange</a></li>
<li><a href="#async-and-concurrency">Async and Concurrency</a></li>
<li><a href="#rpc-and-distributed-computing">RPC and Distributed
Computing</a></li>
<li><a href="#synchronisation-primitives">Synchronisation
Primitives</a></li>
<li><a href="#tls-secure-connections">TLS Secure Connections</a></li>
<li><a href="#publisher-subscriber-model">Publisher / Subscriber
Model</a></li>
<li><a href="#surveyor-respondent-model">Surveyor / Respondent
Model</a></li>
<li><a href="#ncurl-async-http-client">ncurl: (Async) HTTP
Client</a></li>
<li><a href="#stream-websocket-client">stream: Websocket Client</a></li>
<li><a href="#options-serialization-and-statistics">Options,
Serialization and Statistics</a></li>
</ol>
</div>
<div class="section level3">
<h3 id="cross-language-exchange">Cross-language Exchange<a class="anchor" aria-label="anchor" href="#cross-language-exchange"></a>
</h3>
<p><code>nanonext</code> provides a fast and reliable data interface
between different programming languages where NNG has an implementation,
including C, C++, Java, Python, Go, Rust etc.</p>
<p>The following example demonstrates the exchange of numerical data
between R and Python (NumPy), two of the most commonly-used languages
for data science and machine learning.</p>
<p>Using a messaging interface provides a clean and robust approach,
light on resources with limited and identifiable points of failure.</p>
<p>This approach can also serve as an interface / pipe between different
processes written in the same or different languages, running on the
same computer or distributed across networks, and is an enabler of
modular software design as espoused by the Unix philosophy.</p>
<p>One solution it provides is that of processing real-time data where
computation times exceed the data frequency - by dividing the
computation into stages, this may be set up as a pipeline or ‘cascade’
of processes, each connected using NNG sockets.</p>
<p>Create socket in Python using the NNG binding ‘pynng’:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">import</span> pynng</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>socket <span class="op">=</span> pynng.Pair0(listen<span class="op">=</span><span class="st">"ipc:///tmp/nanonext.socket"</span>)</span></code></pre></div>
<p>Create nano object in R using <code>nanonext</code>, then send a
vector of ‘doubles’, specifying mode as ‘raw’:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shikokuchuo.net/nanonext/">nanonext</a></span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nano.html">nano</a></span><span class="op">(</span><span class="st">"pair"</span>, dial <span class="op">=</span> <span class="st">"ipc:///tmp/nanonext.socket"</span><span class="op">)</span></span>
<span><span class="va">n</span><span class="op">$</span><span class="fu">send</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="fl">2.2</span>, <span class="fl">3.3</span>, <span class="fl">4.4</span>, <span class="fl">5.5</span><span class="op">)</span>, mode <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>Receive in Python as a NumPy array of ‘floats’, and send back to
R:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>raw <span class="op">=</span> socket.recv()</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>array <span class="op">=</span> np.frombuffer(raw)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="bu">print</span>(array)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; [1.1 2.2 3.3 4.4 5.5]</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>msg <span class="op">=</span> array.tobytes()</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>socket.send(msg)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>socket.close()</span></code></pre></div>
<p>Receive in R, specifying the receive mode as ‘double’:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span><span class="op">$</span><span class="fu">recv</span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"double"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.1 2.2 3.3 4.4 5.5</span></span>
<span></span>
<span><span class="va">n</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><a href="#table-of-contents">« Back to ToC</a></p>
</div>
<div class="section level3">
<h3 id="async-and-concurrency">Async and Concurrency<a class="anchor" aria-label="anchor" href="#async-and-concurrency"></a>
</h3>
<p><code>nanonext</code> implements true async send and receive,
leveraging NNG as a massively-scaleable concurrency framework.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span><span class="st">"pair"</span>, listen <span class="op">=</span> <span class="st">"inproc://nano"</span><span class="op">)</span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span><span class="st">"pair"</span>, dial <span class="op">=</span> <span class="st">"inproc://nano"</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/send_aio.html">send_aio()</a></code> and <code><a href="../reference/recv_aio.html">recv_aio()</a></code> functions return
immediately with an ‘Aio’ object, but perform their operations
async.</p>
<p>An ‘Aio’ object returns an unresolved value whilst its asynchronous
operation is ongoing, automatically resolving to a final value once
complete.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># an async receive is requested, but no messages are waiting (yet to be sent)</span></span>
<span><span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recv_aio.html">recv_aio</a></span><span class="op">(</span><span class="va">s2</span><span class="op">)</span></span>
<span><span class="va">msg</span></span>
<span><span class="co">#&gt; &lt; recvAio | $data &gt;</span></span>
<span><span class="va">msg</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; 'unresolved' logi NA</span></span></code></pre></div>
<p>For a ‘sendAio’ object, the result is stored at
<code>$result</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/send_aio.html">send_aio</a></span><span class="op">(</span><span class="va">s1</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span>, b <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#&gt; &lt; sendAio | $result &gt;</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">result</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p><em>Note: a return value of 0 denotes a successful send, meaning that
the message has been accepted by the socket for sending; the message
itself may still be buffered within the system.</em></p>
<p>For a ‘recvAio’ object, the message is stored at
<code>$data</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># now that a message has been sent, the 'recvAio' resolves automatically</span></span>
<span><span class="va">msg</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt;   a b</span></span>
<span><span class="co">#&gt; 1 1 2</span></span></code></pre></div>
<p>Auxiliary function <code><a href="../reference/unresolved.html">unresolved()</a></code> may be used in control
flow statements to perform actions which depend on resolution of the
Aio, both before and after. This means there is no need to actually wait
(block) for an Aio to resolve, as the example below demonstrates.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recv_aio.html">recv_aio</a></span><span class="op">(</span><span class="va">s2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># unresolved() queries for resolution itself so no need to use it again within the while loop</span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="fu"><a href="../reference/unresolved.html">unresolved</a></span><span class="op">(</span><span class="va">msg</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># do stuff before checking resolution again</span></span>
<span>  <span class="fu"><a href="../reference/send_aio.html">send_aio</a></span><span class="op">(</span><span class="va">s1</span>, <span class="st">"resolved"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"unresolved"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; unresolved</span></span>
<span></span>
<span><span class="co"># perform actions which depend on the Aio value outside the while loop</span></span>
<span><span class="va">msg</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; [1] "resolved"</span></span></code></pre></div>
<p>The values may also be called explicitly using
<code><a href="../reference/call_aio.html">call_aio()</a></code>. This will wait for completion of the Aio
(blocking).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># will wait for completion then return the resolved Aio</span></span>
<span><span class="fu"><a href="../reference/call_aio.html">call_aio</a></span><span class="op">(</span><span class="va">msg</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># to access the resolved value (waiting if required):</span></span>
<span><span class="fu"><a href="../reference/call_aio.html">call_aio</a></span><span class="op">(</span><span class="va">msg</span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; [1] "resolved"</span></span>
<span></span>
<span><span class="co"># or directly:</span></span>
<span><span class="fu"><a href="../reference/collect_aio.html">collect_aio</a></span><span class="op">(</span><span class="va">msg</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "resolved"</span></span>
<span></span>
<span><span class="co"># or user-interruptible:</span></span>
<span><span class="va">msg</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "resolved"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/close.html">close</a></span><span class="op">(</span><span class="va">s1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/close.html">close</a></span><span class="op">(</span><span class="va">s2</span><span class="op">)</span></span></code></pre></div>
<p><a href="#table-of-contents">« Back to ToC</a></p>
</div>
<div class="section level3">
<h3 id="rpc-and-distributed-computing">RPC and Distributed Computing<a class="anchor" aria-label="anchor" href="#rpc-and-distributed-computing"></a>
</h3>
<p><code>nanonext</code> implements remote procedure calls (RPC) using
NNG’s req/rep protocol to provide a basis for distributed computing.</p>
<p>Can be used to perform computationally-expensive calculations or
I/O-bound operations such as writing large amounts of data to disk in a
separate ‘server’ process running concurrently.</p>
<p>[S] Server process: <code><a href="../reference/reply.html">reply()</a></code> will wait for a message and
apply a function, in this case <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm()</a></code>, before sending back
the result. This is started in a background ‘mirai’ process.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">mirai</span><span class="fu">::</span><span class="fu">mirai</span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shikokuchuo.net/nanonext/">nanonext</a></span><span class="op">)</span></span>
<span>  <span class="va">rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span><span class="st">"rep"</span>, listen <span class="op">=</span> <span class="st">"tcp://127.0.0.1:6556"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/reply.html">reply</a></span><span class="op">(</span><span class="fu"><a href="../reference/context.html">context</a></span><span class="op">(</span><span class="va">rep</span><span class="op">)</span>, execute <span class="op">=</span> <span class="va">rnorm</span>, send_mode <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="co"># linger period to flush system socket send</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>[C] Client process: <code><a href="../reference/request.html">request()</a></code> performs an async send and
receive request and returns immediately with a <code>recvAio</code>
object.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shikokuchuo.net/nanonext/">nanonext</a></span><span class="op">)</span></span>
<span><span class="va">req</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span><span class="st">"req"</span>, dial <span class="op">=</span> <span class="st">"tcp://127.0.0.1:6556"</span><span class="op">)</span></span>
<span><span class="va">aio</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/request.html">request</a></span><span class="op">(</span><span class="fu"><a href="../reference/context.html">context</a></span><span class="op">(</span><span class="va">req</span><span class="op">)</span>, data <span class="op">=</span> <span class="fl">1e8</span>, recv_mode <span class="op">=</span> <span class="st">"double"</span><span class="op">)</span></span></code></pre></div>
<p>At this point, the client can run additional code concurrent with the
server processing the request.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># do more...</span></span></code></pre></div>
<p>When the result of the server calculation is required, the
<code>recvAio</code> may be called using <code><a href="../reference/call_aio.html">call_aio()</a></code>.</p>
<p>The return value from the server request is then retrieved and stored
in the Aio as <code>$data</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/call_aio.html">call_aio</a></span><span class="op">(</span><span class="va">aio</span><span class="op">)</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  num [1:100000000] -0.5043 0.3125 0.2775 -0.7714 -0.0508 ...</span></span></code></pre></div>
<p>As <code><a href="../reference/call_aio.html">call_aio()</a></code> is blocking and will wait for completion,
an alternative is to query <code>aio$data</code> directly. This will
return an ‘unresolved’ logical NA value if the calculation is yet to
complete.</p>
<p>In this example the calculation is returned, but other operations may
reside entirely on the server side, for example writing data to
disk.</p>
<p>In such a case, calling or querying the value confirms that the
operation has completed, and provides the return value of the function,
which may typically be NULL or an exit code.</p>
<p>The <a href="https://doi.org/10.5281/zenodo.7912722" class="external-link"><code>mirai</code></a>
package (<a href="https://shikokuchuo.net/mirai/" class="external-link uri">https://shikokuchuo.net/mirai/</a>) uses
<code>nanonext</code> as the back-end to provide asynchronous execution
of arbitrary R code using the RPC model.</p>
<p><a href="#table-of-contents">« Back to ToC</a></p>
</div>
<div class="section level3">
<h3 id="synchronisation-primitives">Synchronisation Primitives<a class="anchor" aria-label="anchor" href="#synchronisation-primitives"></a>
</h3>
<p><code>nanonext</code> implements cross-platform synchronisation
primitives provided by the NNG library.</p>
<p>As the R interpreter runs on a single thread, synchronisation
primitives such as mutexes and condition variables are not natively
implemented in the R language. However, as NNG is inherently threaded
and messaging can be asynchronous, it is possible to synchronise between
NNG events and the main R execution thread.</p>
<p>The events that can be signalled include asynchronous receive
completions, and pipe events - when connections are established or
dropped.</p>
<p>Condition variables can be used simply to record such events, or more
powerfully, to wait upon them. The condition variables implemented in
<code>nanonext</code> include a both a condition (value) and flag
(boolean). Each signal increments the value, and each successful return
of <code><a href="../reference/cv.html">wait()</a></code> or <code><a href="../reference/cv.html">until()</a></code> decrements the value. A
non-zero condition allows waiting threads to continue.</p>
<p>In any situation where polling for an event presents a solution,
waiting upon a condition to be signalled can be more efficient, both in
terms of consuming no resources while waiting, and also being
synchronised with the event (having no latency).</p>
<p>The following shows how condition variables and signalling work in
practice.</p>
<p>Example 1: set up a socket, and wait for the other side to
connect:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sock</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span><span class="st">"pair"</span>, listen <span class="op">=</span> <span class="st">"inproc://nanopipe"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.html">cv</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># create new condition variable</span></span>
<span><span class="fu"><a href="../reference/cv.html">cv_value</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span></span>
<span><span class="fu"><a href="../reference/pipe_notify.html">pipe_notify</a></span><span class="op">(</span><span class="va">sock</span>, cv <span class="op">=</span> <span class="va">cv</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, remove <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># wait(cv) # uncomment in normal usage - but would block</span></span>
<span></span>
<span><span class="co"># for illustration:</span></span>
<span><span class="va">sock2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span><span class="st">"pair"</span>, dial <span class="op">=</span> <span class="st">"inproc://nanopipe"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/cv.html">cv_value</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span> <span class="co"># incremented when pipe to 'sock2' was created</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span></span>
<span><span class="fu"><a href="../reference/cv.html">wait</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span> <span class="co"># wait() now does not block</span></span>
<span></span>
<span><span class="fu"><a href="../reference/cv.html">cv_value</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span> <span class="co"># wait() decrements the CV value - calling wait() again will block</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span></span>
<span><span class="fu"><a href="../reference/close.html">close</a></span><span class="op">(</span><span class="va">sock2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/cv.html">cv_value</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span> <span class="co"># incremented when pipe to 'sock2' was destroyed</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span></span>
<span><span class="fu"><a href="../reference/close.html">close</a></span><span class="op">(</span><span class="va">sock</span><span class="op">)</span></span></code></pre></div>
<p>Example 2: wait until a message is received or connection is
dropped:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sock</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span><span class="st">"pair"</span>, listen <span class="op">=</span> <span class="st">"inproc://nanosignal"</span><span class="op">)</span></span>
<span><span class="va">sock2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span><span class="st">"pair"</span>, dial <span class="op">=</span> <span class="st">"inproc://nanosignal"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.html">cv</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># create new condition variable</span></span>
<span><span class="fu"><a href="../reference/cv.html">cv_value</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span></span>
<span><span class="fu"><a href="../reference/pipe_notify.html">pipe_notify</a></span><span class="op">(</span><span class="va">sock</span>, cv <span class="op">=</span> <span class="va">cv</span>, add <span class="op">=</span> <span class="cn">FALSE</span>, remove <span class="op">=</span> <span class="cn">TRUE</span>, flag <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/send.html">send</a></span><span class="op">(</span><span class="va">sock2</span>, <span class="st">"this message will wake waiting thread"</span><span class="op">)</span> <span class="co"># in real usage happens concurrently with wait()</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recv_aio.html">recv_aio</a></span><span class="op">(</span><span class="va">sock</span>, cv <span class="op">=</span> <span class="va">cv</span><span class="op">)</span> <span class="co"># same cv passed to recv_aio()</span></span>
<span></span>
<span><span class="co"># wakes as soon as the asynchronous receive completes</span></span>
<span><span class="fu"><a href="../reference/cv.html">wait</a></span><span class="op">(</span><span class="va">cv</span><span class="op">)</span> <span class="op">||</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"peer disconnected"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="va">r</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; [1] "this message will wake waiting thread"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/close.html">close</a></span><span class="op">(</span><span class="va">sock</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/close.html">close</a></span><span class="op">(</span><span class="va">sock2</span><span class="op">)</span></span></code></pre></div>
<p>The above example shows the working of the flag within the condition
variable. As the pipe notification was specified to raise a flag, this
can be used to distinguish between a pipe event signal and a message
receive signal.</p>
<p>In the case a flag is raised, <code><a href="../reference/cv.html">wait()</a></code> returns FALSE
rather than TRUE. So the above code will stop with the custom error
message upon disconnect or else continue. This affords a way of handling
disconnects that would not be possible if simply using
<code><a href="../reference/call_aio.html">call_aio()</a></code>, which is also a blocking wait (on a single
message).</p>
<p>As can be seen, this type of mechanism presents a powerful way of
waiting simulatenously on multiple events, and also distinguishing
between them. <code><a href="../reference/pipe_notify.html">pipe_notify()</a></code> can also be set to signal two
condition variables upon each event, providing even more flexibility in
creating complex concurrent applications.</p>
<p>For further details, please refer to the function documentation for
<code><a href="../reference/cv.html">cv()</a></code>.</p>
<p><a href="#table-of-contents">« Back to ToC</a></p>
</div>
<div class="section level3">
<h3 id="tls-secure-connections">TLS Secure Connections<a class="anchor" aria-label="anchor" href="#tls-secure-connections"></a>
</h3>
<p>Secure connections are enabled through the combination of NNG and
Mbed TLS libraries.</p>
<p>Authentication of endpoints and encryption of the TCP transport layer
is achieved transparently by:</p>
<ol style="list-style-type: lower-roman">
<li>Specifying a secure <code>tls+tcp://</code> or <code>wss://</code>
URL, and</li>
<li>Passing a TLS configuration object to the ‘tls’ argument of
<code><a href="../reference/listen.html">listen()</a></code> or <code><a href="../reference/dial.html">dial()</a></code>.</li>
</ol>
<p>A TLS configuration, or ‘tlsConfig’, object is created by the
<code><a href="../reference/tls_config.html">tls_config()</a></code> function. Specify the argument ‘client’ to
create a client configuration, and ‘server’ to create a server
configuration.</p>
<p>A client configuration requires a PEM-encoded CA certificate (chain)
used to verify the server identity. A server configuration requires the
certificate and associated private key. These may be supplied as files
or directly as character vectors. Valid X.509 certificates generated via
a Certificate Signing Request to a Certificate Authority are supported
in this way.</p>
<p>Additionally, the convenience function <code><a href="../reference/write_cert.html">write_cert()</a></code> can
automatically generate a 4096 bit RSA key pair and self-signed X.509
certificate in the format required by <code><a href="../reference/tls_config.html">tls_config()</a></code>. The
‘cn’ argument must be provided and match exactly the hostname / IP
address of the URL that is being used, e.g. in the example below
‘127.0.0.1’ must be used throughout, or alternatively ‘localhost’, but
not a mixture of the two.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cert</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/write_cert.html">write_cert</a></span><span class="op">(</span>cn <span class="op">=</span> <span class="st">"127.0.0.1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">cert</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ server: chr [1:2] "-----BEGIN CERTIFICATE-----\nMIIFOTCCAyGgAwIBAgIBATANBgkqhkiG9w0BAQsFADA0MRIwEAYDVQQDDAkxMjcu\nMC4wLjExETAPBgNV"| __truncated__ "-----BEGIN RSA PRIVATE KEY-----\nMIIJKQIBAAKCAgEAnqsWJ7vy38KuMIqzwRSEJffVPVNsi21FQlY4z4n5ipmP/k6F\n/mMhN28Ee/+j"| __truncated__</span></span>
<span><span class="co">#&gt;  $ client: chr [1:2] "-----BEGIN CERTIFICATE-----\nMIIFOTCCAyGgAwIBAgIBATANBgkqhkiG9w0BAQsFADA0MRIwEAYDVQQDDAkxMjcu\nMC4wLjExETAPBgNV"| __truncated__ ""</span></span>
<span></span>
<span><span class="va">ser</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tls_config.html">tls_config</a></span><span class="op">(</span>server <span class="op">=</span> <span class="va">cert</span><span class="op">$</span><span class="va">server</span><span class="op">)</span></span>
<span><span class="va">ser</span></span>
<span><span class="co">#&gt; &lt; TLS server config | auth mode: optional &gt;</span></span>
<span></span>
<span><span class="va">cli</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tls_config.html">tls_config</a></span><span class="op">(</span>client <span class="op">=</span> <span class="va">cert</span><span class="op">$</span><span class="va">client</span><span class="op">)</span></span>
<span><span class="va">cli</span></span>
<span><span class="co">#&gt; &lt; TLS client config | auth mode: required &gt;</span></span>
<span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span>listen <span class="op">=</span> <span class="st">"tls+tcp://127.0.0.1:5558"</span>, tls <span class="op">=</span> <span class="va">ser</span><span class="op">)</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span>dial <span class="op">=</span> <span class="st">"tls+tcp://127.0.0.1:5558"</span>, tls <span class="op">=</span> <span class="va">cli</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># secure TLS connection established</span></span>
<span></span>
<span><span class="fu"><a href="../reference/close.html">close</a></span><span class="op">(</span><span class="va">s1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/close.html">close</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></code></pre></div>
<p><a href="#table-of-contents">« Back to ToC</a></p>
</div>
<div class="section level3">
<h3 id="publisher-subscriber-model">Publisher Subscriber Model<a class="anchor" aria-label="anchor" href="#publisher-subscriber-model"></a>
</h3>
<p><code>nanonext</code> fully implements NNG’s pub/sub protocol as per
the below example. A subscriber can subscribe to one or multiple topics
broadcast by a publisher.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span><span class="st">"pub"</span>, listen <span class="op">=</span> <span class="st">"inproc://nanobroadcast"</span><span class="op">)</span></span>
<span><span class="va">sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span><span class="st">"sub"</span>, dial <span class="op">=</span> <span class="st">"inproc://nanobroadcast"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/subscribe.html">subscribe</a></span><span class="op">(</span>topic <span class="op">=</span> <span class="st">"examples"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/send.html">send</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"this is an example"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="va">sub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/recv.html">recv</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"character"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "examples"           "this is an example"</span></span>
<span></span>
<span><span class="va">pub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/send.html">send</a></span><span class="op">(</span><span class="st">"examples at the start of a single text message"</span>, mode <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="va">sub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/recv.html">recv</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"character"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "examples at the start of a single text message"</span></span>
<span></span>
<span><span class="va">pub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/send.html">send</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"other"</span>, <span class="st">"this other topic will not be received"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="va">sub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/recv.html">recv</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"character"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'errorValue' int 8 | Try again</span></span>
<span></span>
<span><span class="co"># specify NULL to subscribe to ALL topics</span></span>
<span><span class="va">sub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/subscribe.html">subscribe</a></span><span class="op">(</span>topic <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">pub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/send.html">send</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"newTopic"</span>, <span class="st">"this is a new topic"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="va">sub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/recv.html">recv</a></span><span class="op">(</span><span class="st">"character"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "newTopic"            "this is a new topic"</span></span>
<span></span>
<span><span class="va">sub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/subscribe.html">unsubscribe</a></span><span class="op">(</span>topic <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">pub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/send.html">send</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"newTopic"</span>, <span class="st">"this topic will now not be received"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="va">sub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/recv.html">recv</a></span><span class="op">(</span><span class="st">"character"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'errorValue' int 8 | Try again</span></span>
<span></span>
<span><span class="co"># however the topics explicitly subscribed to are still received</span></span>
<span><span class="va">pub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/send.html">send</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"examples will still be received"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="va">sub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/recv.html">recv</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"character"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "examples will still be received"</span></span></code></pre></div>
<p>The subscribed topic can be of any atomic type (not just character),
allowing integer, double, logical, complex and raw vectors to be sent
and received.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/subscribe.html">subscribe</a></span><span class="op">(</span>topic <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">pub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/send.html">send</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>, mode <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="va">sub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/recv.html">recv</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"double"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  1 10 10 20</span></span>
<span><span class="va">pub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/send.html">send</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>, mode <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="va">sub</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/recv.html">recv</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"double"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'errorValue' int 8 | Try again</span></span>
<span></span>
<span><span class="fu"><a href="../reference/close.html">close</a></span><span class="op">(</span><span class="va">pub</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/close.html">close</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span></span></code></pre></div>
<p><a href="#table-of-contents">« Back to ToC</a></p>
</div>
<div class="section level3">
<h3 id="surveyor-respondent-model">Surveyor Respondent Model<a class="anchor" aria-label="anchor" href="#surveyor-respondent-model"></a>
</h3>
<p>This type of pattern is useful for applications such as service
discovery.</p>
<p>A surveyor sends a survey, which is broadcast to all peer
respondents. Respondents are then able to reply, but are not obliged to.
The survey itself is a timed event, and responses received after the
timeout are discarded.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sur</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span><span class="st">"surveyor"</span>, listen <span class="op">=</span> <span class="st">"inproc://nanoservice"</span><span class="op">)</span></span>
<span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span><span class="st">"respondent"</span>, dial <span class="op">=</span> <span class="st">"inproc://nanoservice"</span><span class="op">)</span></span>
<span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span><span class="st">"respondent"</span>, dial <span class="op">=</span> <span class="st">"inproc://nanoservice"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sur sets a survey timeout, applying to this and subsequent surveys</span></span>
<span><span class="va">sur</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/survey_time.html">survey_time</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sur sends a message and then requests 2 async receives</span></span>
<span><span class="va">sur</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/send.html">send</a></span><span class="op">(</span><span class="st">"service check"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="va">aio1</span> <span class="op">&lt;-</span> <span class="va">sur</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/recv_aio.html">recv_aio</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">aio2</span> <span class="op">&lt;-</span> <span class="va">sur</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/recv_aio.html">recv_aio</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># res1 receives the message and replies using an aio send function</span></span>
<span><span class="va">res1</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/recv.html">recv</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "service check"</span></span>
<span><span class="va">res1</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/send_aio.html">send_aio</a></span><span class="op">(</span><span class="st">"res1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># res2 receives the message but fails to reply</span></span>
<span><span class="va">res2</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/recv.html">recv</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "service check"</span></span>
<span></span>
<span><span class="co"># checking the aio - only the first will have resolved</span></span>
<span><span class="va">aio1</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; [1] "res1"</span></span>
<span><span class="va">aio2</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; 'unresolved' logi NA</span></span>
<span></span>
<span><span class="co"># after the survey expires, the second resolves into a timeout error</span></span>
<span><span class="fu"><a href="../reference/msleep.html">msleep</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">aio2</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; 'errorValue' int 5 | Timed out</span></span>
<span></span>
<span><span class="fu"><a href="../reference/close.html">close</a></span><span class="op">(</span><span class="va">sur</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/close.html">close</a></span><span class="op">(</span><span class="va">res1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/close.html">close</a></span><span class="op">(</span><span class="va">res2</span><span class="op">)</span></span></code></pre></div>
<p>Above, <code><a href="../reference/msleep.html">msleep()</a></code> is an uninterruptible sleep function
(utilising the NNG library), taking a time in milliseconds.</p>
<p>It can be seen that the final value resolves into a timeout, which is
an integer 5 classed as ‘errorValue’. All integer error codes are
classed as ‘errorValue’ to be easily distinguishable from integer
message values.</p>
<p><a href="#table-of-contents">« Back to ToC</a></p>
</div>
<div class="section level3">
<h3 id="ncurl-async-http-client">ncurl: Async HTTP Client<a class="anchor" aria-label="anchor" href="#ncurl-async-http-client"></a>
</h3>
<p><code><a href="../reference/ncurl.html">ncurl()</a></code> is a minimalist http(s) client.</p>
<p><code><a href="../reference/ncurl_aio.html">ncurl_aio()</a></code> is the async edition, performing requests
asynchronously, returning immediately with an ‘ncurlAio’.</p>
<p>For normal use, it takes just the URL. It can follow redirects.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ncurl.html">ncurl</a></span><span class="op">(</span><span class="st">"https://postman-echo.com/get"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $status</span></span>
<span><span class="co">#&gt; [1] 200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $headers</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; [1] "{\n  \"args\": {},\n  \"headers\": {\n    \"host\": \"postman-echo.com\",\n    \"x-request-start\": \"t=1724104783.065\",\n    \"connection\": \"close\",\n    \"x-forwarded-proto\": \"https\",\n    \"x-forwarded-port\": \"443\",\n    \"x-amzn-trace-id\": \"Root=1-66c3c04f-35f31c774acc1b8d6e4f150f\"\n  },\n  \"url\": \"https://postman-echo.com/get\"\n}"</span></span></code></pre></div>
<p>For advanced use, supports additional HTTP methods such as POST or
PUT.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ncurl_aio.html">ncurl_aio</a></span><span class="op">(</span><span class="st">"https://postman-echo.com/post"</span>,</span>
<span>                 method <span class="op">=</span> <span class="st">"POST"</span>,</span>
<span>                 headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`Content-Type` <span class="op">=</span> <span class="st">"application/json"</span>, Authorization <span class="op">=</span> <span class="st">"Bearer APIKEY"</span><span class="op">)</span>,</span>
<span>                 data <span class="op">=</span> <span class="st">'{"key": "value"}'</span>,</span>
<span>                 response <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#&gt; &lt; ncurlAio | $status $headers $data &gt;</span></span>
<span></span>
<span><span class="fu"><a href="../reference/call_aio.html">call_aio</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">$</span><span class="va">headers</span></span>
<span><span class="co">#&gt; $date</span></span>
<span><span class="co">#&gt; [1] "Mon, 19 Aug 2024 21:59:44 GMT"</span></span>
<span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; [1] "{\n  \"args\": {},\n  \"data\": {\n    \"key\": \"value\"\n  },\n  \"files\": {},\n  \"form\": {},\n  \"headers\": {\n    \"host\": \"postman-echo.com\",\n    \"x-request-start\": \"t=1724104784.075\",\n    \"connection\": \"close\",\n    \"content-length\": \"16\",\n    \"x-forwarded-proto\": \"https\",\n    \"x-forwarded-port\": \"443\",\n    \"x-amzn-trace-id\": \"Root=1-66c3c04f-137ac65c00ca142929b0088a\",\n    \"content-type\": \"application/json\",\n    \"authorization\": \"Bearer APIKEY\"\n  },\n  \"json\": {\n    \"key\": \"value\"\n  },\n  \"url\": \"https://postman-echo.com/post\"\n}"</span></span></code></pre></div>
<p>In this respect, it may be used as a performant and lightweight
method for making REST API requests.</p>
<div class="section level5">
<h5 id="ncurl-promises">ncurl Promises<a class="anchor" aria-label="anchor" href="#ncurl-promises"></a>
</h5>
<p><code><a href="../reference/ncurl_aio.html">ncurl_aio()</a></code> may also be used anywhere that accepts a
‘promise’ from the promises package, including with Shiny
ExtendedTask.</p>
<p>If a status code of 200 (OK) is returned then the promise is resolved
with the reponse body, otherwise it is rejected with a translation of
the status code or ‘errorValue’ as the case may be.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/promises/" class="external-link">promises</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ncurl_aio.html">ncurl_aio</a></span><span class="op">(</span><span class="st">"https://postman-echo.com/get"</span><span class="op">)</span> <span class="op"><a href="https://rstudio.github.io/promises/reference/pipes.html" class="external-link">%...&gt;%</a></span> <span class="va">cat</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/promises/reference/is.promise.html" class="external-link">is.promise</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="ncurl-session">ncurl Session<a class="anchor" aria-label="anchor" href="#ncurl-session"></a>
</h5>
<p><code><a href="../reference/ncurl_session.html">ncurl_session()</a></code> creates a re-usable open connection and
presents a much faster and more efficient solution for repeated polling
of an API endpoint. <code><a href="../reference/ncurl_session.html">transact()</a></code> is then used to request data
multiple times as required. This method allows a polling frequency that
exceeds a server’s new connection limits, where this is permitted.</p>
<p>By specifying <code>convert = FALSE</code>, the received binary data
is made available as a raw vector. This may be fed into ‘json’ parsers
which can operate directly on such data etc.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sess</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ncurl_session.html">ncurl_session</a></span><span class="op">(</span><span class="st">"https://postman-echo.com/get"</span>,</span>
<span>                      convert <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                      headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`Content-Type` <span class="op">=</span> <span class="st">"application/json"</span>, Authorization <span class="op">=</span> <span class="st">"Bearer APIKEY"</span><span class="op">)</span>,</span>
<span>                      response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Date"</span>, <span class="st">"Content-Type"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sess</span></span>
<span><span class="co">#&gt; &lt; ncurlSession &gt; - transact() to return data</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ncurl_session.html">transact</a></span><span class="op">(</span><span class="va">sess</span><span class="op">)</span></span>
<span><span class="co">#&gt; $status</span></span>
<span><span class="co">#&gt; [1] 200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $headers</span></span>
<span><span class="co">#&gt; $headers$Date</span></span>
<span><span class="co">#&gt; [1] "Mon, 19 Aug 2024 21:59:44 GMT"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $headers$`Content-Type`</span></span>
<span><span class="co">#&gt; [1] "application/json; charset=utf-8"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt;   [1] 7b 0a 20 20 22 61 72 67 73 22 3a 20 7b 7d 2c 0a 20 20 22 68 65 61 64 65 72 73 22 3a 20 7b 0a 20 20 20 20 22 68 6f</span></span>
<span><span class="co">#&gt;  [39] 73 74 22 3a 20 22 70 6f 73 74 6d 61 6e 2d 65 63 68 6f 2e 63 6f 6d 22 2c 0a 20 20 20 20 22 78 2d 72 65 71 75 65 73</span></span>
<span><span class="co">#&gt;  [77] 74 2d 73 74 61 72 74 22 3a 20 22 74 3d 31 37 32 34 31 30 34 37 38 34 2e 37 34 35 22 2c 0a 20 20 20 20 22 63 6f 6e</span></span>
<span><span class="co">#&gt; [115] 6e 65 63 74 69 6f 6e 22 3a 20 22 63 6c 6f 73 65 22 2c 0a 20 20 20 20 22 78 2d 66 6f 72 77 61 72 64 65 64 2d 70 72</span></span>
<span><span class="co">#&gt; [153] 6f 74 6f 22 3a 20 22 68 74 74 70 73 22 2c 0a 20 20 20 20 22 78 2d 66 6f 72 77 61 72 64 65 64 2d 70 6f 72 74 22 3a</span></span>
<span><span class="co">#&gt; [191] 20 22 34 34 33 22 2c 0a 20 20 20 20 22 78 2d 61 6d 7a 6e 2d 74 72 61 63 65 2d 69 64 22 3a 20 22 52 6f 6f 74 3d 31</span></span>
<span><span class="co">#&gt; [229] 2d 36 36 63 33 63 30 35 30 2d 34 61 36 33 31 30 63 36 34 61 37 35 63 31 39 37 35 65 61 37 62 31 36 39 22 2c 0a 20</span></span>
<span><span class="co">#&gt; [267] 20 20 20 22 63 6f 6e 74 65 6e 74 2d 74 79 70 65 22 3a 20 22 61 70 70 6c 69 63 61 74 69 6f 6e 2f 6a 73 6f 6e 22 2c</span></span>
<span><span class="co">#&gt; [305] 0a 20 20 20 20 22 61 75 74 68 6f 72 69 7a 61 74 69 6f 6e 22 3a 20 22 42 65 61 72 65 72 20 41 50 49 4b 45 59 22 0a</span></span>
<span><span class="co">#&gt; [343] 20 20 7d 2c 0a 20 20 22 75 72 6c 22 3a 20 22 68 74 74 70 73 3a 2f 2f 70 6f 73 74 6d 61 6e 2d 65 63 68 6f 2e 63 6f</span></span>
<span><span class="co">#&gt; [381] 6d 2f 67 65 74 22 0a 7d</span></span></code></pre></div>
<p><a href="#table-of-contents">« Back to ToC</a></p>
</div>
</div>
<div class="section level3">
<h3 id="stream-websocket-client">stream: Websocket Client<a class="anchor" aria-label="anchor" href="#stream-websocket-client"></a>
</h3>
<p><code><a href="../reference/stream.html">stream()</a></code> exposes NNG’s low-level byte stream interface
for communicating with raw sockets. This may be used for connecting to
arbitrary non-NNG endpoints.</p>
<p>The stream interface can be used to communicate with (secure)
websocket servers. The argument <code>textframes = TRUE</code> can be
specified where the websocket server uses text rather than binary
frames.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># connecting to an echo service</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stream.html">stream</a></span><span class="op">(</span>dial <span class="op">=</span> <span class="st">"wss://echo.websocket.events/"</span>, textframes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">s</span></span>
<span><span class="co">#&gt; &lt; nanoStream &gt;</span></span>
<span><span class="co">#&gt;  - mode: dialer text frames</span></span>
<span><span class="co">#&gt;  - state: opened</span></span>
<span><span class="co">#&gt;  - url: wss://echo.websocket.events/</span></span></code></pre></div>
<p><code><a href="../reference/send.html">send()</a></code> and <code><a href="../reference/recv.html">recv()</a></code>, as well as their
asynchronous counterparts <code><a href="../reference/send_aio.html">send_aio()</a></code> and
<code><a href="../reference/recv_aio.html">recv_aio()</a></code> can be used on Streams in the same way as
Sockets. This affords a great deal of flexibility in ingesting and
processing streaming data.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/recv.html">recv</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "echo.websocket.events sponsored by Lob.com"</span></span>
<span></span>
<span><span class="va">s</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/send.html">send</a></span><span class="op">(</span><span class="st">"initial message"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span></span>
<span><span class="va">s</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/recv.html">recv</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "initial message"</span></span>
<span></span>
<span><span class="va">s</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/recv_aio.html">recv_aio</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">r</span></span>
<span></span>
<span><span class="va">s</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/send.html">send</a></span><span class="op">(</span><span class="st">"async message"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span></span>
<span><span class="va">s</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/send.html">send</a></span><span class="op">(</span><span class="st">"final message"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span></span>
<span><span class="va">s</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/recv.html">recv</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "final message"</span></span>
<span></span>
<span><span class="va">r</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; [1] "async message"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/close.html">close</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></code></pre></div>
<p><a href="#table-of-contents">« Back to ToC</a></p>
</div>
<div class="section level3">
<h3 id="options-serialization-and-statistics">Options, Serialization and Statistics<a class="anchor" aria-label="anchor" href="#options-serialization-and-statistics"></a>
</h3>
<p>Use <code><a href="../reference/opt.html">opt()</a></code> and <code><a href="../reference/opt.html">'opt&lt;-'()</a></code> to get and set
options on a Socket, Context, Stream, Listener or Dialer.</p>
<p>See the function documentation page for a list of common options.</p>
<p>Once a dialer or listener has started, it is not generally possible
to change its configuration. In this case, the dialer or listener should
be created specifying ‘autostart = FALSE’.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span>listen <span class="op">=</span> <span class="st">"inproc://options"</span>, autostart <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># no maximum message size</span></span>
<span><span class="fu"><a href="../reference/opt.html">opt</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">listener</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"recv-size-max"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span></span>
<span><span class="co"># enfore maximum message size to protect against denial-of-service type attacks</span></span>
<span><span class="fu"><a href="../reference/opt.html">opt</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">listener</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"recv-size-max"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">8192L</span></span>
<span></span>
<span><span class="fu"><a href="../reference/opt.html">opt</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">listener</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"recv-size-max"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 8192</span></span>
<span></span>
<span><span class="fu"><a href="../reference/start.html">start</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">listener</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>There is the special write-only option ‘serial’ for Sockets, which
sets a serialization configuration returned by
<code><a href="../reference/serial_config.html">serial_config()</a></code>. This registers custom functions to handle
serialization and unserialization of reference objects, plugging into
the ‘refhook’ system of native R serialization. This allows the
transparent send and receive of such objects using mode ‘serial’ without
the need for a separate ‘marshalling’ step. Once set, configurations
apply to the Socket and all Contexts created from the Socket.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">serial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/serial_config.html">serial_config</a></span><span class="op">(</span><span class="st">"obj_class"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/serialize.html" class="external-link">serialize</a></span><span class="op">(</span><span class="va">x</span>, <span class="cn">NULL</span><span class="op">)</span>, <span class="va">unserialize</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/opt.html">opt</a></span><span class="op">(</span><span class="va">s</span>, <span class="st">"serial"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">serial</span></span>
<span></span>
<span><span class="fu"><a href="../reference/close.html">close</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></code></pre></div>
<p>Similarly <code><a href="../reference/stat.html">stat()</a></code> has been implemented as the interface
to NNG’s statistics framework.</p>
<p>This can be used on a Socket, Listener or Dialer to query useful
statistics such as the total number of connection attempts, the current
number of connections etc.</p>
<p>See the function documentation page for available statistics.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span>listen <span class="op">=</span> <span class="st">"inproc://stat"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># no active connections (pipes)</span></span>
<span><span class="fu"><a href="../reference/stat.html">stat</a></span><span class="op">(</span><span class="va">s</span>, <span class="st">"pipes"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/socket.html">socket</a></span><span class="op">(</span>dial <span class="op">=</span> <span class="st">"inproc://stat"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># one now that the dialer has conneceted</span></span>
<span><span class="fu"><a href="../reference/stat.html">stat</a></span><span class="op">(</span><span class="va">s</span>, <span class="st">"pipes"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span></span>
<span><span class="fu"><a href="../reference/close.html">close</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></code></pre></div>
<p><a href="#table-of-contents">« Back to ToC</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Charlie Gao, <img src="https://r-consortium.org/images/RConsortium_Horizontal_Pantone.webp" alt="R Consortium" width="100" height="22">.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
